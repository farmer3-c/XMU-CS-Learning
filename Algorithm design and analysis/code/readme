This is the code in book.
https://zh.openzlib.link/book/115083153/fcdad6/%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%88%86%E6%9E%90.html
